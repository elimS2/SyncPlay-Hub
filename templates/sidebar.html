<!-- Universal Left Sidebar Navigation Component -->
<!-- Sidebar Icons CSS -->
<link rel="stylesheet" href="/static/css/sidebar-icons.css">

<div class="sidebar">
  <div class="sidebar-header">
    <h1 class="sidebar-title">ðŸŽµ YouTube Player</h1>
  </div>
  
  <nav>
    <ul class="nav-menu">
      <!-- Main Content Section -->
      <li class="nav-item">
        <a href="/" class="nav-link {{ 'active' if request.endpoint in ['playlists', 'playlists_page'] else '' }}">
          <span class="nav-icon nav-icon-home"></span>
          Home / Playlists
        </a>
      </li>
      <li class="nav-item">
        <a href="/tracks" class="nav-link {{ 'active' if request.endpoint == 'tracks' else '' }}">
          <span class="nav-icon nav-icon-tracks"></span>
          Track Library
        </a>
      </li>
      <li class="nav-item">
        <a href="/events" class="nav-link {{ 'active' if request.endpoint == 'events' else '' }}">
          <span class="nav-icon nav-icon-events"></span>
          Events
        </a>
      </li>
      <li class="nav-item">
        <a href="/channels" class="nav-link {{ 'active' if request.endpoint == 'channels' else '' }}">
          <span class="nav-icon nav-icon-channels"></span>
          Channels
        </a>
      </li>
      <li class="nav-item">
        <a href="/jobs" class="nav-link {{ 'active' if request.endpoint == 'jobs' else '' }}">
          <span class="nav-icon nav-icon-jobs"></span>
          Job Queue
        </a>
      </li>
      <li class="nav-item">
        <a href="/deleted" class="nav-link {{ 'active' if request.endpoint == 'deleted' else '' }}">
          <span class="nav-icon nav-icon-deleted"></span>
          Deleted Tracks
        </a>
      </li>
      <li class="nav-item">
        <a href="/remote" class="nav-link {{ 'active' if request.endpoint == 'remote' else '' }}">
          <span class="nav-icon nav-icon-remote"></span>
          Remote Control
        </a>
      </li>
      
      <!-- System Management Section -->
      <li class="nav-item nav-dropdown">
        <a href="#" class="nav-link dropdown-toggle {{ 'active' if request.endpoint in ['settings', 'maintenance_page', 'files', 'logs', 'backups'] else '' }}" onclick="toggleDropdown(event)">
          <span class="nav-icon nav-icon-settings"></span>
          System Management
          <span class="dropdown-arrow">
            <span class="nav-icon nav-icon-dropdown-arrow"></span>
          </span>
        </a>
        <ul class="nav-submenu">
          <li class="nav-subitem">
            <a href="/settings" class="nav-sublink {{ 'active' if request.endpoint == 'settings' else '' }}">
              <span class="nav-icon nav-icon-settings-sub"></span>
              Settings
            </a>
          </li>
          <li class="nav-subitem">
            <a href="/maintenance" class="nav-sublink {{ 'active' if request.endpoint == 'maintenance_page' else '' }}">
              <span class="nav-icon nav-icon-maintenance"></span>
              Maintenance
            </a>
          </li>
          <li class="nav-subitem">
            <a href="/files" class="nav-sublink {{ 'active' if request.endpoint == 'files' else '' }}">
              <span class="nav-icon nav-icon-files"></span>
              Browse Files
            </a>
          </li>
          <li class="nav-subitem">
            <a href="/logs" class="nav-sublink {{ 'active' if request.endpoint == 'logs' else '' }}">
              <span class="nav-icon nav-icon-logs"></span>
              Logs
            </a>
          </li>
          <li class="nav-subitem">
            <a href="/backups" class="nav-sublink {{ 'active' if request.endpoint == 'backups' else '' }}">
              <span class="nav-icon nav-icon-backups"></span>
              Backups
            </a>
          </li>
        </ul>
      </li>
    </ul>
  </nav>
  
  <div class="server-info">
    <div class="server-info-row">
      PID: <span id="server-pid">{{ server_info.pid if server_info else 'N/A' }}</span> | Uptime: <span id="server-uptime">{{ server_info.uptime if server_info else 'N/A' }}</span>
    </div>
    <div class="server-info-row">
      Started: <span id="server-start-time">{{ server_info.start_time if server_info else 'N/A' }}</span>
    </div>
    <div class="server-info-row">
      Current: <span id="server-current-time">{{ server_info.current_time if server_info else 'N/A' }}</span>
    </div>
    <div class="server-info-row">
      <a href="https://github.com/elimS2" target="_blank" class="github-link">
        <span class="nav-icon nav-icon-github"></span>GitHub: elimS2
      </a>
    </div>
  </div>
</div>

<!-- Dropdown Menu JavaScript -->
<script>
function toggleDropdown(event) {
  event.preventDefault();
  const dropdown = event.target.closest('.nav-dropdown');
  const isOpen = dropdown.classList.contains('open');
  
  // Close all other dropdowns
  document.querySelectorAll('.nav-dropdown.open').forEach(item => {
    if (item !== dropdown) {
      item.classList.remove('open');
    }
  });
  
  // Toggle current dropdown
  dropdown.classList.toggle('open', !isOpen);
}

// Close dropdown when clicking outside
document.addEventListener('click', function(event) {
  if (!event.target.closest('.nav-dropdown')) {
    document.querySelectorAll('.nav-dropdown.open').forEach(item => {
      item.classList.remove('open');
    });
  }
});

// Keep dropdown open if one of its sublinks is active
document.addEventListener('DOMContentLoaded', function() {
  const activeSublink = document.querySelector('.nav-sublink.active');
  if (activeSublink) {
    const dropdown = activeSublink.closest('.nav-dropdown');
    if (dropdown) {
      dropdown.classList.add('open');
    }
  }
});

// Dynamic server info updates
function updateServerInfo() {
  fetch('/api/server_info')
    .then(response => response.json())
    .then(data => {
      const currentTimeElement = document.getElementById('server-current-time');
      const uptimeElement = document.getElementById('server-uptime');
      
      if (currentTimeElement) {
        currentTimeElement.textContent = data.current_time;
      }
      if (uptimeElement) {
        uptimeElement.textContent = data.uptime;
      }
    })
    .catch(error => {
      console.log('Failed to update server info:', error);
    });
}

// Update server info every second
document.addEventListener('DOMContentLoaded', function() {
  updateServerInfo(); // Initial update
  setInterval(updateServerInfo, 1000); // Update every second
});
</script> 