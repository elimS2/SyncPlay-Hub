<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>❤️ {{ like_count }} Like{{ 's' if like_count != 1 else '' }} - Virtual Playlist</title>
  <!-- Favicon using emoji -->
  <link rel="icon" href="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='0.9em' font-size='90'>❤️</text></svg>">
  <style>
    :root{
      --bg: rgba(0,0,0,.7);
      --text:#fff;
      --progress-bg:#444;
      --progress-fill:#fff;
      --page-bg:#000;
      --playing-bg:#333;
      --playing-text:#fff;
    }
    @media (prefers-color-scheme: light){
      :root{
        --bg: rgba(255,255,255,.8);
        --text:#000;
        --progress-bg:#ccc;
        --progress-fill:#000;
        --page-bg:#fff;
        --playing-bg:#e6e6e6;
        --playing-text:#000;
      }
    }

    body { font-family: Arial, sans-serif; margin: 20px; background:var(--page-bg); color:var(--text);}
    #tracklist {
      list-style: none;
      padding: 0;
      height: calc(100vh - 140px); /* nearly full viewport height accounting for header/buttons */
      overflow-y: auto;
    }
    /* custom scrollbar styling */
    #tracklist::-webkit-scrollbar {
      width: 8px;
    }
    #tracklist::-webkit-scrollbar-track {
      background: var(--bg);
    }
    #tracklist::-webkit-scrollbar-thumb {
      background: var(--progress-bg);
      border-radius: 4px;
    }
    #tracklist:hover::-webkit-scrollbar-thumb {
      background: var(--progress-fill);
    }
    /* Firefox */
    #tracklist {
      scrollbar-width: thin;
      scrollbar-color: var(--progress-fill) var(--bg);
    }
    #tracklist li { padding: 4px; cursor: pointer; color:var(--text); }
    #tracklist li:hover {background: rgba(128,128,128,.2);}
    #tracklist li.playing { background: var(--playing-bg); color:var(--playing-text); font-weight:600; }
    button { margin-right: 10px; }
    .controls{position:absolute;bottom:0;left:0;width:100%;display:flex;align-items:center;background:var(--bg);padding:6px 10px;box-sizing:border-box;transition:opacity .25s;}
    .controls.hidden{opacity:0;pointer-events:none;}
    #controlBar.hidden{display:none;}
    .left-group{display:flex;align-items:center;}
    .ctrl-btn{
      background:rgba(255,255,255,0.1);border:none;color:var(--text);font-size:20px;margin:0 4px;cursor:pointer;
      display:inline-flex;align-items:center;justify-content:center;
      width:40px;height:40px;border-radius:8px;
      transition:all 0.2s ease;
      backdrop-filter:blur(10px);
      border:1px solid rgba(255,255,255,0.1);
    }
    .ctrl-btn:hover{
      transform:translateY(-2px);
      background:rgba(255,255,255,0.2);
      box-shadow:0 4px 12px rgba(0,0,0,0.3);
      border-color:rgba(255,255,255,0.3);
    }
    .ctrl-btn:active{
      transform:translateY(0);
      box-shadow:0 2px 6px rgba(0,0,0,0.2);
    }
    .ctrl-btn.like-active{
      color:#e74c3c;
    }
    .ctrl-btn.like-active svg {
      fill: #e74c3c;
      stroke: #e74c3c;
    }
    .progress{flex:1;height:6px;background:var(--progress-bg);margin:0 8px;border-radius:3px;cursor:pointer;}
    .progress-bar{height:100%;width:0%;background:var(--progress-fill);border-radius:3px;}
    .time{color:var(--text);font-size:12px;margin-right:8px;white-space:nowrap;}
    .vol-slider{
      width:80px;margin-left:8px;
      -webkit-appearance:none;
      height:4px;
      border-radius:2px;
      background:rgba(255,255,255,0.3);
      outline:none;
      transition:all 0.2s ease;
    }
    .vol-slider::-webkit-slider-thumb{
      -webkit-appearance:none;
      appearance:none;
      width:16px;height:16px;
      border-radius:50%;
      background:var(--text);
      cursor:pointer;
      transition:all 0.2s ease;
      box-shadow:0 2px 4px rgba(0,0,0,0.3);
    }
    .vol-slider::-webkit-slider-thumb:hover{
      transform:scale(1.2);
      background:#fff;
    }
    .vol-slider::-moz-range-thumb{
      width:16px;height:16px;
      border-radius:50%;
      background:var(--text);
      cursor:pointer;
      border:none;
      transition:all 0.2s ease;
      box-shadow:0 2px 4px rgba(0,0,0,0.3);
    }
    .vol-slider::-moz-range-thumb:hover{
      transform:scale(1.2);
      background:#fff;
    }
    
    /* Enhanced progress bar styling */
    .progress{
      flex:1;height:8px;background:rgba(255,255,255,0.2);
      margin:0 12px;border-radius:4px;cursor:pointer;
      transition:height 0.2s ease;
      position:relative;
      overflow:hidden;
    }
    .progress:hover{height:12px;}
    .progress-bar{
      height:100%;width:0%;
      background:rgba(255,255,255,0.8);
      border-radius:4px;
      transition:all 0.2s ease;
      position:relative;
    }
    .progress-bar::after{
      content:'';
      position:absolute;
      top:0;right:0;
      width:3px;height:100%;
      background:rgba(255,255,255,1);
      border-radius:2px;
      box-shadow:0 0 6px rgba(255,255,255,0.6);
    }

    /* fullscreen adjustments */
    #videoWrapper:fullscreen video{width:100%;height:100%;object-fit:contain;}
    #videoWrapper:-webkit-full-screen video{width:100%;height:100%;object-fit:contain;}
    .player-container{display:flex;gap:12px;}
    /* Playlist panel wrapper */
    .playlist-panel{display:flex;flex-direction:column;width:600px;max-height:70vh;transition:width .3s ease;border-left:1px solid rgba(255,255,255,.1);}
    .playlist-panel.collapsed{width:0;border-left:none;overflow:hidden;}
    .playlist-panel.collapsed .side-list{display:none;}
    .side-list{list-style:none;margin:0;padding:0;flex:1 1 auto;overflow-y:auto;}
    /* control bar layout */
    .control-bar{display:flex;align-items:center;gap:8px;flex-wrap:wrap;padding:12px 0;}
    
    /* Modern Button Styles */
    .modern-btn {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 10px 16px;
      border: none;
      border-radius: 8px;
      font-size: 14px;
      font-weight: 500;
      font-family: inherit;
      cursor: pointer;
      transition: all 0.2s ease;
      text-decoration: none;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      position: relative;
      overflow: hidden;
    }
    
    .modern-btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 8px rgba(0,0,0,0.15);
    }
    
    .modern-btn:active {
      transform: translateY(0);
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    
    .modern-btn-primary {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
    }
    
    .modern-btn-secondary {
      background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      color: white;
    }
    
    .modern-btn-accent {
      background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
      color: white;
    }
    
    .modern-btn-success {
      background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
      color: white;
    }
    
    .modern-btn-danger {
      background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
      color: white;
    }
    
    .modern-btn-outline {
      background: transparent;
      color: var(--text);
      border: 2px solid rgba(255,255,255,0.3);
    }
    
    .modern-btn-outline:hover {
      background: rgba(255,255,255,0.1);
      border-color: rgba(255,255,255,0.5);
    }
    
    /* Virtual playlist specific styles */
    .virtual-playlist-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
    }
    
    .likes-badge {
      background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
      padding: 4px 12px;
      border-radius: 20px;
      font-weight: bold;
      color: white;
      font-size: 18px;
    }
  </style>
</head>
<body>
  <div class="virtual-playlist-header">
    <a href="/likes" style="color:#61dafb;text-decoration:none;font-size:16px;">← Virtual Playlists</a>
    <span style="font-size:20px;color:var(--text);">
      ❤️ <span class="likes-badge">{{ like_count }}</span> like{{ 's' if like_count != 1 else '' }}
    </span>
  </div>
  <div id="controlBar" class="control-bar">
    <button id="prevBtn" class="modern-btn modern-btn-secondary">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <polygon points="19,20 9,12 19,4"></polygon>
        <line x1="5" y1="19" x2="5" y2="5"></line>
      </svg>
      <span>Prev</span>
    </button>
    <button id="playBtn" class="modern-btn modern-btn-primary">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <polygon points="5,3 19,12 5,21"></polygon>
      </svg>
      <span>Play</span>
    </button>
    <button id="nextBtn" class="modern-btn modern-btn-secondary">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <polygon points="5,4 15,12 5,20"></polygon>
        <line x1="19" y1="5" x2="19" y2="19"></line>
      </svg>
      <span>Next</span>
    </button>
    <button id="shuffleBtn" class="modern-btn modern-btn-accent">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <polyline points="16,3 21,3 21,8"></polyline>
        <line x1="4" y1="20" x2="21" y2="3"></line>
        <polyline points="21,16 21,21 16,21"></polyline>
        <line x1="15" y1="15" x2="21" y2="21"></line>
        <line x1="4" y1="4" x2="9" y2="9"></line>
      </svg>
      <span>Shuffle</span>
    </button>
    <button id="smartShuffleBtn" class="modern-btn modern-btn-accent">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M12 2a3 3 0 0 1 3 3c0 1-1 3-3 3s-3-2-3-3a3 3 0 0 1 3-3Z"></path>
        <path d="M19 11c-.64-.64-1.27-.68-2.5 0-2.5 1.4-6 1.4-8.5 0-.68-.68-1.26-.64-2.5 0-.64.64-.68 1.27 0 2.5 1.4 2.5 1.4 6 0 8.5-.68.68-.64 1.26 0 2.5.64.64 1.27.68 2.5 0 2.5-1.4 6-1.4 8.5 0 .68.68 1.26.64 2.5 0 .64-.64.68-1.27 0-2.5-1.4-2.5-1.4-6 0-8.5Z"></path>
      </svg>
      <span>Smart</span>
    </button>
    <button id="stopBtn" class="modern-btn modern-btn-danger">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <rect x="6" y="6" width="12" height="12" rx="2"></rect>
      </svg>
      <span>Stop</span>
    </button>
    <button id="deleteCurrentBtn" class="modern-btn modern-btn-danger">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <polyline points="3,6 5,6 21,6"></polyline>
        <path d="M19,6V20a2,2 0 0,1 -2,2H7a2,2 0 0,1 -2,-2V6M8,6V4a2,2 0 0,1 2,-2h4a2,2 0 0,1 2,2V6"></path>
        <line x1="10" y1="11" x2="10" y2="17"></line>
        <line x1="14" y1="11" x2="14" y2="17"></line>
      </svg>
      <span>Delete</span>
    </button>
    <button id="fullBtn" class="modern-btn modern-btn-secondary">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M8 3H5a2 2 0 0 0-2 2v3"></path>
        <path d="M21 8V5a2 2 0 0 0-2-2h-3"></path>
        <path d="M3 16v3a2 2 0 0 0 2 2h3"></path>
        <path d="M16 21h3a2 2 0 0 0 2-2v-3"></path>
      </svg>
      <span>Full</span>
    </button>
    <button id="toggleListBtn" class="modern-btn modern-btn-outline">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <line x1="4" y1="6" x2="20" y2="6"></line>
        <line x1="4" y1="12" x2="20" y2="12"></line>
        <line x1="4" y1="18" x2="20" y2="18"></line>
      </svg>
      <span>Playlist</span>
    </button>
  </div>
  <div id="playerContainer" class="player-container" style="margin-top:10px; position:relative;">
    <div id="videoWrapper" style="position:relative; flex:1 1 auto;">
      <video id="player" style="width:100%;" playsinline></video>
      <!-- custom control bar -->
      <div id="customControls" class="controls">
        <div class="left-group">
          <button id="cPrev" class="ctrl-btn" title="Previous">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <polygon points="19,20 9,12 19,4"></polygon>
              <line x1="5" y1="19" x2="5" y2="5"></line>
            </svg>
          </button>
          <button id="cPlay" class="ctrl-btn" title="Play/Pause">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <polygon points="5,3 19,12 5,21"></polygon>
            </svg>
          </button>
          <button id="cNext" class="ctrl-btn" title="Next">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <polygon points="5,4 15,12 5,20"></polygon>
              <line x1="19" y1="5" x2="19" y2="19"></line>
            </svg>
          </button>
          <button id="cLike" class="ctrl-btn" title="Like">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
            </svg>
          </button>
          <button id="cYoutube" class="ctrl-btn" title="Open on YouTube">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M2.5 17a24.12 24.12 0 0 1 0-10 2 2 0 0 1 1.4-1.4 49.56 49.56 0 0 1 16.2 0A2 2 0 0 1 21.5 7a24.12 24.12 0 0 1 0 10 2 2 0 0 1-1.4 1.4 49.55 49.55 0 0 1-16.2 0A2 2 0 0 1 2.5 17"></path>
              <polygon points="10,8 16,12 10,16"></polygon>
            </svg>
          </button>
          <button id="cMute" class="ctrl-btn" title="Mute/Unmute">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon>
              <path d="M15.54 8.46a5 5 0 0 1 0 7.07"></path>
              <path d="M19.07 4.93a10 10 0 0 1 0 14.14"></path>
            </svg>
          </button>
          <input type="range" id="cVol" min="0" max="1" step="0.05" value="1" class="vol-slider" />
        </div>
        <div id="progressContainer" class="progress"><div id="progressBar" class="progress-bar"></div></div>
        <span id="timeLabel" class="time">0:00 / 0:00</span>
        <button id="cFull" class="ctrl-btn" title="Fullscreen">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M8 3H5a2 2 0 0 0-2 2v3"></path>
            <path d="M21 8V5a2 2 0 0 0-2-2h-3"></path>
            <path d="M3 16v3a2 2 0 0 0 2 2h3"></path>
            <path d="M16 21h3a2 2 0 0 0 2-2v-3"></path>
          </svg>
        </button>
      </div>
    </div>
    <div id="playlistPanel" class="playlist-panel">
      <ul id="tracklist" class="side-list"></ul>
    </div>
  </div>

  <!-- Virtual playlist configuration -->
  <script>
    // Set like count for virtual playlist
    const VIRTUAL_PLAYLIST_LIKE_COUNT = {{ like_count }};
    const PLAYLIST_REL = ''; // Virtual playlist has no relpath
    
    console.log(`🎵 [Virtual] Configuring virtual playlist for ${VIRTUAL_PLAYLIST_LIKE_COUNT} likes`);
  </script>

  <!-- Load specialized virtual player -->
  <script src="/static/player-virtual.js"></script>
</body>
</html> 